<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NOC Letter Generator</title>

<!-- jsPDF CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  background:#f2f4f7;
  font-family: Arial, sans-serif;
  padding:30px;
}
.card{
  max-width:800px;
  margin:auto;
  background:#ffffff;
  padding:35px;
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}
h1{
  text-align:center;
  color:#1f4fd8;
  margin-bottom:20px;
}
input{
  width:100%;
  padding:12px;
  margin:8px 0;
  font-size:15px;
}
button{
  width:100%;
  padding:14px;
  background:#1f4fd8;
  color:#fff;
  border:none;
  font-size:16px;
  cursor:pointer;
}
button:hover{
  background:#163bb3;
}
</style>
</head>

<body>

<div class="card">
  <h1>NOC (Letter)</h1>

  <input id="name" placeholder="Customer Name">
  <input id="mobile" placeholder="Mobile Number">
  <input id="amount" placeholder="Amount (INR)">
  <input id="tx" placeholder="Transaction ID">

  <button onclick="generatePDF()">Download NOC PDF</button>
</div>

<script>
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const name = document.getElementById("name").value.trim();
  const mobile = document.getElementById("mobile").value.trim();
  const amount = document.getElementById("amount").value.trim();
  const tx = document.getElementById("tx").value.trim();

  if(!name || !mobile || !amount || !tx){
    alert("সব ফিল্ড পূরণ করুন");
    return;
  }

  const now = new Date();
  const ref = "NOC-" + now.getFullYear() + "-" + Math.floor(100000 + Math.random()*900000);
  const dt = now.toLocaleString("en-IN");

  doc.setFontSize(20);
  doc.text("NO OBJECTION CERTIFICATE (NOC)",105,20,null,null,"center");

  doc.setFontSize(11);
  doc.text("Reference No: " + ref,20,35);
  doc.text("Date & Time: " + dt,140,35);

  doc.text("Customer Name: " + name,20,50);
  doc.text("Mobile Number: " + mobile,20,58);

  doc.setFontSize(12);
  doc.text(
    "This is to certify that Mr./Ms. " + name +
    ", holding mobile number " + mobile +
    ", has taken a loan of INR " + amount +
    " and has successfully repaid the same through our secure online payment system.",
    20,75,{maxWidth:170}
  );

  doc.text(
    "We hereby declare that we have no objection regarding this transaction. "
    + "The payment is valid, lawful and no dispute shall arise in future.",
    20,105,{maxWidth:170}
  );

  doc.text(
    "This NOC is issued for official and verification purposes only.",
    20,130,{maxWidth:170}
  );

  doc.line(20,155,190,155);

  doc.text("Amount Paid: INR " + amount,20,165);
  doc.text("Transaction ID: " + tx,20,175);

  doc.text(
    "Note: This document is system-generated and does not require any signature.",
    20,190
  );

  doc.save("NOC_" + name + ".pdf");
}
</script>

</body>
</html>
