<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NOC Letter Generator</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  background:#eef2f7;
  font-family: Arial, sans-serif;
  padding:30px;
}
.card{
  max-width:820px;
  margin:auto;
  background:#ffffff;
  padding:35px;
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,0.12);
}
h1{
  text-align:center;
  color:#0d47a1;
  margin-bottom:25px;
}
input{
  width:100%;
  padding:12px;
  margin:8px 0;
  font-size:15px;
}
button{
  width:100%;
  padding:14px;
  background:#0d47a1;
  color:#fff;
  border:none;
  font-size:16px;
  cursor:pointer;
}
button:hover{
  background:#093170;
}
</style>
</head>

<body>

<div class="card">
  <h1>NO OBJECTION CERTIFICATE (NOC)</h1>

  <input id="name" placeholder="Customer Name">
  <input id="mobile" placeholder="Mobile Number">
  <input id="amount" placeholder="Amount (INR)">
  <input id="tx" placeholder="Transaction ID">

  <button onclick="generatePDF()">Download NOC PDF</button>
</div>

<script>
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const name = document.getElementById("name").value.trim();
  const mobile = document.getElementById("mobile").value.trim();
  const amount = document.getElementById("amount").value.trim();
  const tx = document.getElementById("tx").value.trim();

  if(!name || !mobile || !amount || !tx){
    alert("সব ফিল্ড পূরণ করুন");
    return;
  }

  const now = new Date();
  const ref = "NOC-" + now.getFullYear() + "-" + Math.floor(100000 + Math.random()*900000);
  const dt = now.toLocaleString("en-IN");

  /* ===== HEADER ===== */
  doc.setFontSize(22);
  doc.setTextColor(13,71,161);
  doc.setFont("helvetica","bold");
  doc.text("NO OBJECTION CERTIFICATE",105,22,null,null,"center");

  doc.setDrawColor(13,71,161);
  doc.line(20,26,190,26);

  /* ===== META ===== */
  doc.setFontSize(11);
  doc.setTextColor(0,0,0);
  doc.setFont("helvetica","normal");
  doc.text("Reference No: " + ref,20,38);
  doc.text("Date & Time: " + dt,140,38);

  doc.setFont("helvetica","bold");
  doc.text("Customer Name:",20,50);
  doc.text("Mobile Number:",20,58);

  doc.setFont("helvetica","normal");
  doc.text(name,65,50);
  doc.text(mobile,65,58);

  /* ===== BODY ===== */
  doc.setFontSize(12);
  doc.setFont("helvetica","bold");
  doc.text("NO OBJECTION CERTIFICATE (NOC)",105,75,null,null,"center");

  doc.setFont("helvetica","normal");
  doc.text(
    "This is to certify that Mr./Ms. " + name +
    ", holding the registered mobile number " + mobile +
    ", has taken a loan from us and has successfully repaid the same through our secure online payment system.",
    20,90,{maxWidth:170}
  );

  doc.text(
    "We hereby declare with full confidence that we have no objection regarding this transaction. "
    + "The payment is valid, lawful, and no claim or dispute shall arise in future.",
    20,115,{maxWidth:170}
  );

  doc.text(
    "This No Objection Certificate is issued solely for official and verification purposes.",
    20,140,{maxWidth:170}
  );

  /* ===== AMOUNT BOX ===== */
  doc.setDrawColor(200);
  doc.rect(20,155,170,25);

  doc.setFont("helvetica","bold");
  doc.setTextColor(0,128,0);
  doc.text("Amount Paid: INR " + amount,25,170);

  doc.setTextColor(0,0,0);
  doc.text("Transaction ID: " + tx,25,178);

  /* ===== FOOTER ===== */
  doc.setFontSize(10);
  doc.setFont("helvetica","italic");
  doc.text(
    "Note: This document is system-generated and does not require any signature.",
    105,195,null,null,"center"
  );

  doc.save("NOC_" + name + ".pdf");
}
</script>

</body>
</html>
