<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Auto NOC PDF Generator</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#eef1f4;
  padding:40px;
}
.box{
  max-width:520px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}
input,button{
  width:100%;
  padding:10px;
  margin-top:10px;
  font-size:15px;
}
button{
  background:#0a7cff;
  color:#fff;
  border:none;
  cursor:pointer;
}
#qr{display:none;}
small{color:#555;}
</style>
</head>

<body>

<div class="box">
  <h2>Indian Payment NOC (Auto)</h2>

  <input id="name" placeholder="Customer Name" required>
  <input id="mobile" placeholder="Customer Mobile Number" required>
  <input id="amount" type="number" placeholder="Amount (INR)" required>

  <button onclick="generatePDF()">Download NOC PDF</button>

  <small>
    ✔ QR Code & Watermark<br>
    ✔ English + Hindi (Dual)<br>
    ✔ Bank / UPI / Official Use
  </small>
</div>

<div id="qr"></div>

<script>
// -------- Amount to Words (INR) ----------
function numberToWords(num){
  const a=['','One','Two','Three','Four','Five','Six','Seven','Eight','Nine',
  'Ten','Eleven','Twelve','Thirteen','Fourteen','Fifteen','Sixteen',
  'Seventeen','Eighteen','Nineteen'];
  const b=['','','Twenty','Thirty','Forty','Fifty','Sixty','Seventy','Eighty','Ninety'];
  if(num.length>9) return 'Overflow';
  let n=('000000000'+num).substr(-9).match(/.{1,2}/g);
  let str='';
  str+=(n[0]!=0)?(a[n[0]]||b[n[0][0]]+' '+a[n[0][1]])+' Crore ':'';
  str+=(n[1]!=0)?(a[n[1]]||b[n[1][0]]+' '+a[n[1][1]])+' Lakh ':'';
  str+=(n[2]!=0)?(a[n[2]]||b[n[2][0]]+' '+a[n[2][1]])+' Thousand ':'';
  str+=(n[3]!=0)?(a[n[3]]||b[n[3][0]]+' '+a[n[3][1]])+' Hundred ':'';
  str+=(n[4]!=0)?((str!='')?'and ':'')+(a[n[4]]||b[n[4][0]]+' '+a[n[4][1]]):'';
  return str+' Only';
}

// -------- Generate PDF ----------
function generatePDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const name = nameInput = document.getElementById("name").value;
  const mobile = document.getElementById("mobile").value;
  const amount = document.getElementById("amount").value;

  const words = numberToWords(amount);
  const now = new Date();
  const dateTime = now.toLocaleString();
  const ref = "NOC-" + now.getFullYear() + "-" + Math.floor(100000 + Math.random()*900000);

  // -------- Watermark ----------
  doc.setTextColor(220);
  doc.setFontSize(40);
  doc.text("AUTO GENERATED NOC",35,150,{angle:45});

  doc.setTextColor(0);
  doc.setFontSize(16);
  doc.setFont("Times","Bold");
  doc.text("NO OBJECTION CERTIFICATE (NOC)",105,25,null,null,"center");

  doc.setFontSize(11);
  doc.setFont("Times","Normal");
  doc.text("Reference No: " + ref,20,38);
  doc.text("Date & Time: " + dateTime,20,46);

  // -------- English Section ----------
  const eng = `
This is to certify that there is no objection regarding the payment
of INR ${amount} (${words}) made / to be made by
Mr./Ms. ${name}, Mobile Number: ${mobile}.

The above-mentioned transaction is acknowledged and no claim,
dispute or objection shall be raised in future with respect to
this payment.

This No Objection Certificate is system generated for Indian
Bank / UPI / Official documentation purposes.
`;
  doc.text(eng,20,65);

  // -------- Hindi Section ----------
  const hindi = `
यह प्रमाणित किया जाता है कि श्री/सुश्री ${name}
मोबाइल नंबर ${mobile} द्वारा किए गए / किए जाने वाले
INR ${amount} के भुगतान पर कोई आपत्ति नहीं है।

उपरोक्त लेन-देन को स्वीकार किया जाता है और भविष्य में
इस भुगतान के संबंध में कोई दावा, विवाद या आपत्ति नहीं की जाएगी।

यह अनापत्ति प्रमाण पत्र भारतीय बैंक / UPI / आधिकारिक
दस्तावेज़ीकरण प्रयोजनों के लिए स्वचालित रूप से जारी किया गया है।
`;
  doc.text(hindi,20,125);

  // -------- QR Code ----------
  const qrData = `Ref:${ref} | Name:${name} | Amount:${amount}`;
  const qrDiv = document.getElementById("qr");
  qrDiv.innerHTML = "";
  new QRCode(qrDiv,{text:qrData,width:100,height:100});
  const qrImg = qrDiv.querySelector("img");

  doc.addImage(qrImg.src,"PNG",150,150,40,40);

  doc.setFontSize(10);
  doc.text("System Generated Document – No Signature Required",20,190);

  doc.save(ref + ".pdf");
}
</script>

</body>
</html>